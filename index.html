<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Taylor Swift Era Quest</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-color: #fef6f9;
    transition: background-color 0.5s ease;
  }
  #game-container {
    text-align: center;
    background: white;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    width: 90%;
    max-width: 500px;
  }
  .era-btn {
    display: block;
    width: 100%;
    margin: 0.5rem 0;
    padding: 0.8rem;
    font-size: 1.1rem;
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
    background-color: #eee;
    transition: all 0.3s ease;
  }
  .era-btn:hover {
    background-color: #ddd;
  }
  .completed {
    background-color: #b2fab4 !important;
    box-shadow: 0 0 10px #4caf50;
  }
  .question {
    margin-bottom: 1rem;
    font-weight: 600;
  }
  .choice {
    display: block;
    margin: 0.4rem 0;
    padding: 0.6rem;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    cursor: pointer;
  }
  .choice:hover {
    background-color: #f0f0f0;
  }
  #feedback {
    margin-top: 1rem;
    font-weight: 600;
  }
  #retry-btn {
    margin-top: 1rem;
    display: none;
    padding: 0.6rem 1rem;
    background-color: #ff91c8;
    color: white;
    border: none;
    border-radius: 0.5rem;
    cursor: pointer;
  }
  #gift-btn {
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    font-size: 2rem;
    cursor: pointer;
    animation: float 2s ease-in-out infinite;
  }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }
  #final-message {
    display: none;
    font-size: 1.2rem;
    margin-top: 1rem;
  }
  canvas {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
  }
</style>
</head>
<body>
<div id="game-container"></div>
<div id="gift-btn">üéÅ</div>
<canvas id="confetti"></canvas>
<script>
const eras = {
  Lover: {
    color: '#ffd6e8',
    questions: [
      {q: "Which song opens the Lover album?", a: ["I Forgot That You Existed", "Lover", "The Archer", "Me!"], c: 0},
      {q: "Who features on 'ME!'?", a: ["Brendon Urie", "Ed Sheeran", "Shawn Mendes", "Selena Gomez"], c: 0},
      {q: "What year was Lover released?", a: ["2017", "2018", "2019", "2020"], c: 2}
    ]
  },
  '1989': {
    color: '#d6e8ff',
    questions: [
      {q: "Which song won the Grammy for Album of the Year in 1989?", a: ["Shake It Off", "Blank Space", "1989", "Bad Blood"], c: 2},
      {q: "Where was Taylor born?", a: ["Reading, Pennsylvania", "Nashville, Tennessee", "Los Angeles", "New York City"], c: 0},
      {q: "Which single includes the line 'Got a long list of ex-lovers'?", a: ["Blank Space", "Style", "Wildest Dreams", "Out of the Woods"], c: 0}
    ]
  },
  Red: {
    color: '#ffd6d6',
    questions: [
      {q: "What song features the lyric 'Loving him was red'?", a: ["22", "Red", "Begin Again", "Treacherous"], c: 1},
      {q: "Who is featured in 'Everything Has Changed'?", a: ["Shawn Mendes", "Ed Sheeran", "John Mayer", "Harry Styles"], c: 1},
      {q: "What year was the original Red album released?", a: ["2011", "2012", "2013", "2014"], c: 1}
    ]
  },
  Folklore: {
    color: '#f5efe6',
    questions: [
      {q: "Which song references 'Cardigan'?", a: ["August", "Betty", "Cardigan", "The 1"], c: 2},
      {q: "What year was Folklore released?", a: ["2019", "2020", "2021", "2022"], c: 1},
      {q: "Who collaborated with Taylor on 'Exile'?", a: ["Bon Iver", "Ed Sheeran", "Haim", "Aaron Dessner"], c: 0}
    ]
  },
  Midnights: {
    color: '#d6d6ff',
    questions: [
      {q: "What track opens the Midnights album?", a: ["Anti-Hero", "Lavender Haze", "Midnight Rain", "Maroon"], c: 1},
      {q: "Which song includes the line 'It's me, hi, I'm the problem, it's me'?", a: ["Bejeweled", "Maroon", "Anti-Hero", "Karma"], c: 2},
      {q: "Who did Taylor collaborate with on 'Snow On The Beach'?", a: ["Billie Eilish", "Lana Del Rey", "Phoebe Bridgers", "Halsey"], c: 1}
    ]
  }
};

let completedEras = {};
let currentEra = null;
let currentQuestionIndex = 0;
const container = document.getElementById('game-container');
const giftBtn = document.getElementById('gift-btn');
const confettiCanvas = document.getElementById('confetti');
const ctx = confettiCanvas.getContext('2d');
confettiCanvas.width = window.innerWidth;
confettiCanvas.height = window.innerHeight;

function showEraSelection() {
  document.body.style.backgroundColor = '#fef6f9';
  container.innerHTML = '<h2>Select an Era</h2>';
  for (let era in eras) {
    const btn = document.createElement('button');
    btn.textContent = era;
    btn.className = 'era-btn';
    if (completedEras[era]) btn.classList.add('completed');
    btn.onclick = () => startEra(era);
    container.appendChild(btn);
  }
  checkCompletion();
}

function startEra(era) {
  currentEra = era;
  currentQuestionIndex = 0;
  document.body.style.backgroundColor = eras[era].color;
  showQuestion();
}

function showQuestion() {
  const qData = eras[currentEra].questions[currentQuestionIndex];
  container.innerHTML = `<div class='question'>${qData.q}</div>`;
  qData.a.forEach((choice, i) => {
    const btn = document.createElement('button');
    btn.textContent = choice;
    btn.className = 'choice';
    btn.onclick = () => checkAnswer(i);
    container.appendChild(btn);
  });
  const feedback = document.createElement('div');
  feedback.id = 'feedback';
  container.appendChild(feedback);
  const retry = document.createElement('button');
  retry.id = 'retry-btn';
  retry.textContent = 'Try Again';
  retry.onclick = showQuestion;
  container.appendChild(retry);
}

function checkAnswer(selected) {
  const qData = eras[currentEra].questions[currentQuestionIndex];
  const feedback = document.getElementById('feedback');
  const retry = document.getElementById('retry-btn');
  if (selected === qData.c) {
    feedback.textContent = '‚úÖ Correct!';
    retry.style.display = 'none';
    currentQuestionIndex++;
    if (currentQuestionIndex < eras[currentEra].questions.length) {
      setTimeout(showQuestion, 800);
    } else {
      completedEras[currentEra] = true;
      setTimeout(showEraSelection, 1000);
    }
  } else {
    feedback.textContent = '‚ùå Wrong!';
    retry.style.display = 'inline-block';
  }
}

function checkCompletion() {
  if (Object.keys(eras).every(e => completedEras[e])) {
    giftBtn.style.display = 'block';
  }
}

giftBtn.onclick = () => {
  container.innerHTML = `<h2>üéâ Happy Birthday my love! Eres la persona m√°s importante para m√≠ y espero que este regalo te haya gustado mucho. Gracias por todo lo que has hecho para m√≠ en tantos a√±os, te amo con todo lo que tengo y espero que hoy a sido el mejor cumplea√±os de tu vida.

 üéâ</h2><p id='final-message'>You're a true Swiftie! üíï</p>`;
  startConfetti();
};

// Confetti + hearts animation (few seconds)
function startConfetti() {
  const pieces = [];
  for (let i = 0; i < 150; i++) {
    pieces.push({
      x: Math.random() * confettiCanvas.width,
      y: Math.random() * confettiCanvas.height - confettiCanvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 50,
      color: `hsl(${Math.random() * 360}, 100%, 70%)`,
      tilt: Math.random() * 10 - 10,
      emoji: Math.random() < 0.3 ? 'üíñ' : null
    });
  }
  let duration = 5000;
  const start = Date.now();
  function draw() {
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
    const elapsed = Date.now() - start;
    if (elapsed > duration) return;
    pieces.forEach(p => {
      p.y += 3;
      p.x += Math.sin(p.d);
      if (p.y > confettiCanvas.height) p.y = 0;
      if (p.emoji) {
        ctx.font = `${p.r * 2}px serif`;
        ctx.fillText(p.emoji, p.x, p.y);
      } else {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.fill();
      }
    });
    requestAnimationFrame(draw);
  }
  draw();
}

showEraSelection();
</script>
</body>
</html>
